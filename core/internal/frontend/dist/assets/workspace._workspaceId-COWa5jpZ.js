import{i as pe,p as be,r as c,j as e,T as C,k,d as x,m as d,n as M,o as ge,q as P,s as ve,u as K,t as je,f as ye,b as G,v as A,c as we,w as H,A as I,X as D,x as Ne,y as Se,O as Ce}from"./index-CpZxSUIv.js";import{B as Q}from"./button-Dg0U9FK5.js";import{u as $}from"./useTranslation-Dso8I3TU.js";import{P as ke,s as Me,L as Ae,a as Le,S as Ie,b as Te,c as Pe,M as Oe}from"./index-D0Myp46v.js";import{P as z,S as Re}from"./scroll-area-BbIXkMYn.js";import{F as T}from"./flask-conical-Bx-Kdz2A.js";import{S as $e}from"./SandboxConfirmDialog-Cjj8-xsL.js";import{F as ze}from"./file-text-BM1p6ZkV.js";import{F as Ee}from"./folder-open-DJasdxmj.js";import{V as _e}from"./variable-3C44vvOu.js";import{S as We,a as Fe,b as Be,c as He,d as De}from"./sheet-CuD6qUNf.js";import{L as Ve,T as qe}from"./ThemeToggle-Tzbz5vRi.js";import{C as Ke}from"./chevron-right-8-sJLHkA.js";import{B as Ge}from"./i18n-Ucv7sX-g.js";import"./dropdown-menu-71yQQtU7.js";import"./Combination-Qqga0vmI.js";import"./dialog-D4OJuJXR.js";import"./circle-alert-yxRzE8Mw.js";const Qe=1024,N=pe()(be((t,a)=>({isCollapsed:!1,isMobileOpen:!1,isPinned:!0,isHovering:!1,toggleCollapsed:()=>t({isCollapsed:!a().isCollapsed}),setCollapsed:s=>t({isCollapsed:s}),toggleMobileOpen:()=>t({isMobileOpen:!a().isMobileOpen}),setMobileOpen:s=>t({isMobileOpen:s}),closeMobile:()=>t({isMobileOpen:!1}),togglePinned:()=>{const s=!a().isPinned;t({isPinned:s,isHovering:!1})},setPinned:s=>t({isPinned:s,isHovering:!1}),setHovering:s=>t({isHovering:s})}),{name:"doc-assembly-sidebar",partialize:t=>({isCollapsed:t.isCollapsed,isPinned:t.isPinned})}));function Xe(){const t=N(s=>s.closeMobile),a=N(s=>s.isMobileOpen);c.useEffect(()=>{if(typeof window>"u")return;const s=()=>{window.innerWidth>=Qe&&a&&t()};return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[t,a])}function Ue({className:t}){const{t:a}=$(),{isPinned:s,togglePinned:n}=N(),i=a(s?"sidebar.unpin":"sidebar.pin");return e.jsxs(C,{children:[e.jsx(k,{asChild:!0,children:e.jsx(Q,{variant:"outline",size:"icon",onClick:n,"aria-label":i,className:x("absolute right-0 top-1/2 z-10 h-7 w-7 -translate-y-1/2 translate-x-1/2 rounded-full border bg-background shadow-sm transition-all hover:scale-105 hover:bg-accent",s&&"border-admin/50 bg-background",t),children:e.jsx(d.div,{initial:!1,animate:{rotate:s?45:0},transition:{duration:.2,ease:[.4,0,.2,1]},children:e.jsx(ke,{size:14,className:x("transition-colors duration-200",s?"fill-admin text-admin":"text-muted-foreground")})})})}),e.jsx(M,{side:"right",sideOffset:8,children:i})]})}function Ye(t,a=[]){let s=[];function n(o,u){const r=c.createContext(u);r.displayName=o+"Context";const l=s.length;s=[...s,u];const h=p=>{var f;const{scope:b,children:y,...j}=p,g=((f=b==null?void 0:b[t])==null?void 0:f[l])||r,S=c.useMemo(()=>j,Object.values(j));return e.jsx(g.Provider,{value:S,children:y})};h.displayName=o+"Provider";function v(p,b){var g;const y=((g=b==null?void 0:b[t])==null?void 0:g[l])||r,j=c.useContext(y);if(j)return j;if(u!==void 0)return u;throw new Error(`\`${p}\` must be used within \`${o}\``)}return[h,v]}const i=()=>{const o=s.map(u=>c.createContext(u));return function(r){const l=(r==null?void 0:r[t])||o;return c.useMemo(()=>({[`__scope${t}`]:{...r,[t]:l}}),[r,l])}};return i.scopeName=t,[n,Je(i,...a)]}function Je(...t){const a=t[0];if(t.length===1)return a;const s=()=>{const n=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(o){const u=n.reduce((r,{useScope:l,scopeName:h})=>{const p=l(o)[`__scope${h}`];return{...r,...p}},{});return c.useMemo(()=>({[`__scope${a.scopeName}`]:u}),[u])}};return s.scopeName=a.scopeName,s}function Ze(){return Me.useSyncExternalStore(et,()=>!0,()=>!1)}function et(){return()=>{}}var E="Avatar",[tt]=Ye(E),[st,X]=tt(E),U=c.forwardRef((t,a)=>{const{__scopeAvatar:s,...n}=t,[i,o]=c.useState("idle");return e.jsx(st,{scope:s,imageLoadingStatus:i,onImageLoadingStatusChange:o,children:e.jsx(z.span,{...n,ref:a})})});U.displayName=E;var Y="AvatarImage",J=c.forwardRef((t,a)=>{const{__scopeAvatar:s,src:n,onLoadingStatusChange:i=()=>{},...o}=t,u=X(Y,s),r=at(n,o),l=ge(h=>{i(h),u.onImageLoadingStatusChange(h)});return P(()=>{r!=="idle"&&l(r)},[r,l]),r==="loaded"?e.jsx(z.img,{...o,ref:a,src:n}):null});J.displayName=Y;var Z="AvatarFallback",ee=c.forwardRef((t,a)=>{const{__scopeAvatar:s,delayMs:n,...i}=t,o=X(Z,s),[u,r]=c.useState(n===void 0);return c.useEffect(()=>{if(n!==void 0){const l=window.setTimeout(()=>r(!0),n);return()=>window.clearTimeout(l)}},[n]),u&&o.imageLoadingStatus!=="loaded"?e.jsx(z.span,{...i,ref:a}):null});ee.displayName=Z;function V(t,a){return t?a?(t.src!==a&&(t.src=a),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function at(t,{referrerPolicy:a,crossOrigin:s}){const n=Ze(),i=c.useRef(null),o=n?(i.current||(i.current=new window.Image),i.current):null,[u,r]=c.useState(()=>V(o,t));return P(()=>{r(V(o,t))},[o,t]),P(()=>{const l=p=>()=>{r(p)};if(!o)return;const h=l("loaded"),v=l("error");return o.addEventListener("load",h),o.addEventListener("error",v),a&&(o.referrerPolicy=a),typeof s=="string"&&(o.crossOrigin=s),()=>{o.removeEventListener("load",h),o.removeEventListener("error",v)}},[o,s,a]),u}var te=U,se=J,ae=ee;const O=c.forwardRef(({className:t,...a},s)=>e.jsx(te,{ref:s,className:x("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...a}));O.displayName=te.displayName;const nt=c.forwardRef(({className:t,...a},s)=>e.jsx(se,{ref:s,className:x("aspect-square h-full w-full",t),...a}));nt.displayName=se.displayName;const R=c.forwardRef(({className:t,...a},s)=>e.jsx(ae,{ref:s,className:x("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...a}));R.displayName=ae.displayName;function q({variant:t="badge",className:a,showLabel:s=!0}){const{t:n}=$();return t==="label"?e.jsxs("div",{className:x("flex items-center gap-1.5","font-mono text-xs font-medium uppercase tracking-widest","text-sandbox",a),children:[e.jsx(T,{size:14,strokeWidth:1.5}),s&&e.jsx("span",{children:n("sandbox.label","Sandbox")})]}):t==="inline"?e.jsx("span",{className:x("inline-flex items-center gap-1 text-sandbox",a),children:e.jsx(T,{size:14,strokeWidth:1.5})}):e.jsxs(d.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.15},className:x("inline-flex items-center gap-1.5 px-2 py-1","border border-sandbox-border bg-sandbox-muted","font-mono text-xs font-semibold uppercase tracking-widest","text-sandbox-foreground",a),children:[e.jsx(T,{size:14,strokeWidth:2}),s&&e.jsx("span",{children:n("sandbox.label","Sandbox")})]})}const it={hidden:{opacity:0,x:-20},visible:{opacity:1,x:0}},ot={initial:{opacity:1,height:"auto"},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0,marginTop:0,marginBottom:0,transition:{duration:.2,ease:[.4,0,.2,1]}}},rt={hidden:{opacity:0,scale:0},visible:{opacity:1,scale:1}};function ne({isExpanded:t,onNavigate:a,showAnimations:s=!0}){const{t:n}=$(),i=ve(),o=K(),u=je(),{userProfile:r}=ye(),{currentWorkspace:l,clearContext:h,isSystemContext:v}=G(),{isSandboxActive:p,disableSandbox:b}=A(),{phase:y}=we(),[j,g]=c.useState(!1),S=y==="idle"||y==="complete",f=(l==null?void 0:l.id)||"",_=[{label:n("nav.dashboard"),icon:Ae,href:`/workspace/${f}`,showInSandbox:!1},{label:n("nav.templates"),icon:ze,href:`/workspace/${f}/templates`,showInSandbox:!0},{label:n("nav.documents"),icon:Ee,href:`/workspace/${f}/documents`,showInSandbox:!0},{label:n("nav.signing"),icon:Le,href:`/workspace/${f}/signing`,showInSandbox:!1},{label:n("nav.variables"),icon:_e,href:`/workspace/${f}/variables`,showInSandbox:!0},{label:n("nav.settings"),icon:Ie,href:`/workspace/${f}/settings`,showInSandbox:!1},...v()?[{label:n("nav.administration","Administration"),icon:Te,href:`/workspace/${f}/administration`,showInSandbox:!1}]:[]],ie=p?_.filter(m=>m.showInSandbox):_,oe=r&&(`${r.firstName||""} ${r.lastName||""}`.trim()||r.username)||"User",W=(r==null?void 0:r.email)||"user@example.com",re=H(oe),le=async()=>{a==null||a(),h(),await Se(),o({to:"/login"})},ce=()=>{a==null||a()},de=()=>{b(),u.invalidateQueries({queryKey:["templates"]}),u.invalidateQueries({queryKey:["folders"]}),g(!1);const m=`/workspace/${f}/templates`,w=`/workspace/${f}/documents`,B="folderId"in i.search,xe=i.pathname.startsWith(m)&&i.pathname!==m,me=i.pathname.startsWith(w)&&i.pathname!==w,fe=i.pathname.startsWith(m),he=i.pathname.startsWith(w);xe||fe&&B?o({to:m}):(me||he&&B)&&o({to:w})},ue=m=>m===`/workspace/${f}`?i.pathname===m:i.pathname.startsWith(m),F=s?.8:0;return e.jsxs(e.Fragment,{children:[e.jsxs(Re,{className:x("flex-1 py-6",t?"px-4":"px-2"),children:[l&&e.jsxs("div",{className:"relative mb-8 px-1",children:[e.jsx(d.div,{initial:!1,animate:{opacity:t||!S?0:1,scale:t?.8:1},transition:{duration:.2,ease:[.4,0,.2,1]},className:"absolute inset-0 flex items-center",style:{pointerEvents:t||!S?"none":"auto"},children:e.jsxs(C,{children:[e.jsx(k,{asChild:!0,children:e.jsx(O,{className:"h-10 w-10 cursor-default",children:e.jsx(R,{className:"bg-primary/10 text-sm font-bold",children:H(l.name)})})}),e.jsxs(M,{side:"right",sideOffset:8,children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:n("workspace.current")}),e.jsx("div",{className:"font-medium",children:l.name}),p&&e.jsx("div",{className:"mt-1",children:e.jsx(q,{variant:"badge"})})]})]})}),e.jsx(d.div,{initial:!1,animate:{opacity:t?1:0,x:t?0:-10},transition:{duration:.2,ease:[.4,0,.2,1]},className:"flex h-10 items-center",style:{pointerEvents:t?"auto":"none"},children:e.jsxs("div",{style:{opacity:S?1:0},children:[e.jsx("label",{className:"block text-[10px] font-mono uppercase tracking-widest text-muted-foreground",children:n("workspace.current")}),e.jsx("div",{className:"truncate font-display text-lg font-medium",children:l.name})]})}),e.jsx(I,{children:p&&t&&e.jsxs(d.div,{initial:{opacity:0,y:-5,height:0},animate:{opacity:1,y:0,height:"auto"},exit:{opacity:0,y:-5,height:0},transition:{duration:.2},className:"mt-2 flex items-center justify-between",children:[e.jsx(q,{variant:"label"}),e.jsxs(C,{children:[e.jsx(k,{asChild:!0,children:e.jsx("button",{onClick:()=>g(!0),className:"flex h-6 w-6 items-center justify-center rounded text-sandbox transition-colors hover:bg-sandbox-muted",children:e.jsx(D,{size:14,strokeWidth:2})})}),e.jsx(M,{side:"right",sideOffset:8,children:n("sandbox.exit","Exit Sandbox")})]})]})}),e.jsx(I,{children:p&&!t&&e.jsx(d.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},className:"mt-2 flex justify-center",children:e.jsxs(C,{children:[e.jsx(k,{asChild:!0,children:e.jsx("button",{onClick:()=>g(!0),className:"flex h-8 w-8 items-center justify-center rounded border border-sandbox-border bg-sandbox-muted text-sandbox transition-colors hover:bg-sandbox/20",children:e.jsx(D,{size:14,strokeWidth:2})})}),e.jsxs(M,{side:"right",sideOffset:8,children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:n("sandbox.label","Sandbox")}),e.jsx("div",{className:"font-medium",children:n("sandbox.exit","Exit Sandbox")})]})]})})})]}),e.jsx("nav",{className:"space-y-1",children:e.jsx(I,{mode:"popLayout",initial:!1,children:ie.map((m,w)=>{const L=ue(m.href);return e.jsx(d.div,{variants:ot,initial:"initial",animate:"animate",exit:"exit",children:e.jsx(d.div,{variants:s?it:void 0,initial:s?"hidden":!1,animate:s?"visible":!1,transition:{duration:.3,delay:F+w*.08},children:e.jsxs(Ne,{to:m.href,onClick:ce,className:x("group flex w-full items-center gap-4 rounded-md px-3 py-3 text-sm font-medium transition-colors",L?"bg-sidebar-accent text-sidebar-accent-foreground":"text-muted-foreground hover:bg-sidebar-accent hover:text-sidebar-accent-foreground"),children:[e.jsx(m.icon,{size:20,strokeWidth:1.5,className:x("shrink-0",L?"text-sidebar-accent-foreground":"text-muted-foreground group-hover:text-sidebar-accent-foreground")}),e.jsx(d.span,{initial:!1,animate:{opacity:t?1:0,width:t?"auto":0},transition:{duration:.15,ease:[.4,0,.2,1]},className:"overflow-hidden whitespace-nowrap font-mono",children:m.label})]})})},m.href)})})})]}),e.jsxs("div",{className:x("border-t py-4",t?"px-4":"px-2"),children:[e.jsxs("div",{className:"flex items-center gap-3 rounded-md px-2 py-2",children:[e.jsxs(C,{children:[e.jsx(k,{asChild:!0,children:e.jsx(O,{className:"h-8 w-8 shrink-0 cursor-default",children:e.jsx(R,{className:"text-xs font-bold",children:re})})}),!t&&e.jsxs(M,{side:"right",sideOffset:8,children:[e.jsx("div",{className:"font-medium",children:W}),e.jsx("div",{className:"text-xs text-muted-foreground",children:(l==null?void 0:l.role)||"Member"})]})]}),e.jsxs(d.div,{initial:!1,animate:{opacity:t?1:0,width:t?"auto":0},transition:{duration:.15,ease:[.4,0,.2,1]},className:"min-w-0 overflow-hidden",children:[e.jsx("div",{className:"truncate text-xs font-semibold whitespace-nowrap",children:W}),e.jsx("div",{className:"text-[10px] uppercase text-muted-foreground whitespace-nowrap",children:(l==null?void 0:l.role)||"Member"})]})]}),e.jsx(d.div,{variants:s?rt:void 0,initial:s?"hidden":!1,animate:s?"visible":!1,transition:{duration:.3,delay:F},children:e.jsxs("button",{onClick:le,className:"group flex w-full items-center gap-4 rounded-md px-3 py-3 text-sm font-medium text-muted-foreground transition-colors hover:text-foreground",children:[e.jsx(Pe,{size:20,strokeWidth:1.5,className:"shrink-0 transition-transform group-hover:-translate-x-1"}),e.jsx(d.span,{initial:!1,animate:{opacity:t?1:0,width:t?"auto":0},transition:{duration:.15,ease:[.4,0,.2,1]},className:"overflow-hidden whitespace-nowrap font-mono",children:n("nav.logout")})]})})]}),e.jsx($e,{open:j,onOpenChange:g,action:"disable",onConfirm:de})]})}function lt(){const{isPinned:t,isHovering:a,closeMobile:s}=N(),{isSandboxActive:n}=A(),i=t||a;return e.jsxs(d.aside,{initial:!1,animate:{width:i?256:64},transition:{duration:.2,ease:[.4,0,.2,1]},className:x("relative flex h-full flex-col overflow-visible bg-sidebar-background pt-16",n&&"border-l-2 border-l-sandbox"),children:[e.jsx("div",{className:"hidden lg:block",children:e.jsx(Ue,{})}),e.jsx(d.div,{className:"absolute right-0 top-0 bottom-0 w-px bg-border origin-top",initial:{scaleY:0},animate:{scaleY:1},transition:{duration:.5,delay:.3}}),e.jsx(ne,{isExpanded:i,onNavigate:s,showAnimations:!0})]})}function ct(){const{isMobileOpen:t,closeMobile:a}=N(),{isSandboxActive:s}=A();return e.jsx(We,{open:t,onOpenChange:n=>!n&&a(),children:e.jsxs(Fe,{side:"left",className:x("flex w-[280px] flex-col p-0 pt-16",s&&"border-l-2 border-l-sandbox"),children:[e.jsxs(Be,{className:"sr-only",children:[e.jsx(He,{children:"Navigation Menu"}),e.jsx(De,{children:"Main navigation sidebar"})]}),e.jsx(ne,{isExpanded:!0,onNavigate:a,showAnimations:!1})]})})}function dt({className:t}){const a=K(),{currentTenant:s,currentWorkspace:n,setCurrentWorkspace:i,setCurrentTenant:o}=G();if(!s)return null;const u=()=>{o(null),a({to:"/select-tenant"})},r=()=>{i(null),a({to:"/select-tenant"})};return e.jsxs(d.nav,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3,delay:.2},className:x("flex items-center gap-2",t),"aria-label":"Context navigation",children:[e.jsx("span",{className:"text-border",children:"Â·"}),e.jsx("button",{onClick:u,className:"max-w-[120px] truncate font-mono text-xs text-muted-foreground transition-colors hover:text-foreground md:max-w-[180px]",title:s.name,children:s.name}),n&&e.jsxs(e.Fragment,{children:[e.jsx(Ke,{size:12,className:"text-muted-foreground/50"}),e.jsx("button",{onClick:r,className:"max-w-[120px] truncate font-mono text-xs text-muted-foreground transition-colors hover:text-foreground md:max-w-[180px]",title:n.name,children:n.name})]})]})}function ut({variant:t="minimal",className:a,showMobileMenu:s=!1,onMobileMenuToggle:n}){const i=t==="minimal",{isSandboxActive:o}=A();return e.jsxs(d.header,{className:x("fixed left-0 right-0 top-0 z-50 flex h-16 items-center justify-between bg-background",i?"px-6 md:px-12 lg:px-32":"px-4 sm:px-6",a),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s&&e.jsx(Q,{variant:"ghost",size:"icon",onClick:n,className:"shrink-0 lg:hidden","aria-label":"Toggle navigation menu",children:e.jsx(Oe,{className:"h-5 w-5"})}),e.jsxs(d.div,{layoutId:"app-logo",className:"flex items-center gap-3",children:[e.jsx(d.div,{layoutId:"app-logo-icon",className:x("flex h-8 w-8 items-center justify-center border-2 transition-colors",o?"border-sandbox":"border-foreground"),children:e.jsx(Ge,{size:16,fill:"currentColor",className:x("transition-colors",o?"text-sandbox":"text-foreground")})}),e.jsx(d.span,{layoutId:"app-logo-text",className:x("font-display text-lg font-bold uppercase tracking-tight transition-colors",o?"text-sandbox":"text-foreground"),children:"Doc-Assembly"})]}),!i&&e.jsx("div",{className:"hidden sm:block",children:e.jsx(dt,{})})]}),e.jsxs(d.div,{layoutId:"app-controls",className:"flex shrink-0 items-center gap-1",children:[e.jsx(Ve,{}),e.jsx(qe,{})]}),e.jsx(d.div,{className:"absolute bottom-0 left-0 right-0 h-px bg-border origin-left",initial:{scaleX:0},animate:{scaleX:i?0:1},transition:{duration:.5,delay:.3}})]})}const xt={initial:{opacity:1},animate:{opacity:1}};function mt(){const{toggleMobileOpen:t,isPinned:a,setHovering:s}=N(),n=c.useRef(null);Xe();const i=c.useCallback(()=>{a||(n.current&&(clearTimeout(n.current),n.current=null),s(!0))},[a,s]),o=c.useCallback(()=>{a||(n.current=setTimeout(()=>{s(!1)},150))},[a,s]);return c.useEffect(()=>()=>{n.current&&clearTimeout(n.current)},[]),e.jsxs("div",{className:"flex h-screen overflow-hidden bg-background",children:[e.jsx(ut,{variant:"full",showMobileMenu:!0,onMobileMenuToggle:t}),e.jsx(ct,{}),e.jsx(d.div,{variants:xt,initial:"initial",animate:"animate",className:"hidden lg:block lg:relative",onMouseEnter:i,onMouseLeave:o,children:e.jsx(lt,{})}),e.jsx("main",{className:"flex flex-1 flex-col overflow-hidden pt-16",children:e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx(Ce,{})})})]})}function Pt(){return e.jsx(mt,{})}export{Pt as component};
