import{a as se,u as ae,b as ne,r as o,c as oe,j as e,m as n,A as M,d as $,e as z}from"./index-BVcXaeV0.js";import{L as re,T as ie}from"./ThemeToggle-DU6W_SXM.js";import{u as le,P as W}from"./useWorkspaces-BHtwPByK.js";import{u as ce}from"./useMutation-SYhjC3hS.js";import{u as de}from"./useTranslation--JTkVOXT.js";import{B as ue}from"./i18n-C7M-KfK-.js";import{A as me}from"./arrow-left-DWc5mqqE.js";import{S as xe}from"./search-BDCQFqKF.js";import{A as R}from"./arrow-right-DlMAxOTU.js";import"./button-C7lAKen3.js";import"./dropdown-menu-BVASkqnj.js";import"./Combination-BxN-rzwS.js";import"./chevron-right-BdPLJ7ep.js";import"./chevron-left-BJVZnuJP.js";async function pe(a=1,i=20,l){return(await se.get("/me/tenants",{params:{page:a,perPage:i,...l&&{q:l}}})).data}function fe(a=1,i=20,l){return ce({queryKey:["my-tenants",a,i,l],queryFn:()=>pe(a,i,l),staleTime:0,gcTime:0})}const B={hidden:{opacity:1},visible:{opacity:1,transition:{staggerChildren:.08}},exit:{opacity:1,transition:{staggerChildren:.05,staggerDirection:1}}},O={hidden:{opacity:0,x:0},visible:{opacity:1,x:0,transition:{duration:.3}},exit:{opacity:0,x:-50,transition:{duration:.25,ease:"easeIn"}}},F=5,ge=400;function H(){const[a,i]=o.useState("");return o.useEffect(()=>{const l=setInterval(()=>{i(c=>c.length>=3?"":c+".")},400);return()=>clearInterval(l)},[]),e.jsx("span",{className:"inline-block w-6 text-left",children:a})}function Q(a){if(!a)return"Never";const i=new Date(a),c=new Date().getTime()-i.getTime(),f=Math.floor(c/6e4),r=Math.floor(c/36e5),m=Math.floor(c/864e5),s=Math.floor(m/7);return f<1?"Just now":f<60?`${f} min${f>1?"s":""} ago`:r<24?`${r} hour${r>1?"s":""} ago`:m<7?`${m} day${m>1?"s":""} ago`:`${s} week${s>1?"s":""} ago`}function Ie(){const{t:a}=de(),i=ae(),{setCurrentTenant:l,setCurrentWorkspace:c,currentTenant:f}=ne(),[r,m]=o.useState(""),[s,v]=o.useState(f),[g,N]=o.useState(1),[h,T]=o.useState(1),[_,G]=o.useState(1),[K,w]=o.useState(1),{startTransition:V,setPhase:k,phase:S}=oe(),y=S!=="idle"&&S!=="complete",C=r.length>=3?r:void 0,{data:d,isLoading:q}=fe(g,F,C),{data:u,isLoading:J}=le((s==null?void 0:s.id)??null,h,F,s?C:void 0),x=d==null?void 0:d.pagination,p=u==null?void 0:u.pagination,[P,A]=o.useState(!1),[Y,L]=o.useState(!1);o.useEffect(()=>{A(!1);const t=setTimeout(()=>A(!0),1e3);return()=>clearTimeout(t)},[s]),o.useEffect(()=>{T(1),w(1)},[s==null?void 0:s.id]),o.useEffect(()=>{N(1)},[r]),o.useEffect(()=>{if(r.length>0&&r.length<3){const t=setTimeout(()=>L(!0),300);return()=>clearTimeout(t)}else L(!1)},[r]),o.useEffect(()=>{x!=null&&x.totalPages&&G(x.totalPages)},[x==null?void 0:x.totalPages]),o.useEffect(()=>{p!=null&&p.totalPages&&w(p.totalPages)},[p==null?void 0:p.totalPages]);const U=!P||q||!(d!=null&&d.data),X=!P||J||s&&!(u!=null&&u.data),E=(d==null?void 0:d.data)??[],I=(u==null?void 0:u.data)??[],Z=t=>{m(""),l(t),v(t),z("TENANT",t.id).catch(()=>{})},D=async(t,j)=>{const te=j.currentTarget.getBoundingClientRect();V({id:t.id,name:t.name},te),await new Promise(b=>setTimeout(b,600)),k("fadeBorders"),await new Promise(b=>setTimeout(b,400)),k("fadeOut"),c(t),z("WORKSPACE",t.id).catch(()=>{}),i({to:"/workspace/$workspaceId",params:{workspaceId:t.id}})},ee=()=>{s?(v(null),l(null)):i({to:"/login"})};return e.jsxs("div",{className:"relative flex min-h-screen flex-col items-center bg-background pt-32 lg:pt-40",children:[e.jsxs(n.div,{layoutId:"app-logo",className:"absolute left-6 top-8 flex items-center gap-3 md:left-12 lg:left-32",children:[e.jsx(n.div,{layoutId:"app-logo-icon",className:"flex h-6 w-6 items-center justify-center border-2 border-foreground",children:e.jsx(ue,{size:12,fill:"currentColor",className:"text-foreground"})}),e.jsx(n.span,{layoutId:"app-logo-text",className:"font-display text-sm font-bold uppercase tracking-tight text-foreground",children:"Doc-Assembly"})]}),e.jsxs(n.div,{layoutId:"app-controls",className:"absolute right-6 top-8 flex items-center gap-1 md:right-12 lg:right-32",children:[e.jsx(re,{}),e.jsx(ie,{})]}),e.jsxs(n.div,{animate:{opacity:y?0:1},transition:{duration:0},className:"mx-auto grid w-full max-w-7xl grid-cols-1 items-start gap-16 px-6 py-24 md:px-12 lg:grid-cols-12 lg:gap-24 lg:px-32",children:[e.jsxs(n.div,{layout:!0,className:"lg:sticky lg:top-32 lg:col-span-4",children:[e.jsx(M,{children:s&&e.jsxs(n.div,{layout:!0,initial:{opacity:0,y:-10},animate:{opacity:1,y:0,transition:{duration:.4,ease:"easeOut"}},exit:{opacity:0,y:-10,transition:{duration:.4,ease:"easeIn"}},className:"mb-6",children:[e.jsx("span",{className:"font-mono text-[10px] font-medium uppercase tracking-widest text-muted-foreground",children:"Organization"}),e.jsx("p",{className:"mt-1 font-display text-lg font-medium tracking-tight text-foreground",children:s.name})]},"org-indicator")}),e.jsxs(n.div,{layout:!0,transition:{duration:.4,ease:"easeOut"},children:[e.jsx("h1",{className:"mb-8 font-display text-5xl font-light leading-[1.05] tracking-tighter text-foreground md:text-6xl",children:s?e.jsxs(e.Fragment,{children:["Select your",e.jsx("br",{}),e.jsx("span",{className:"font-semibold",children:"Workspace."})]}):e.jsxs(e.Fragment,{children:[a("selectTenant.title","Select your"),e.jsx("br",{}),e.jsx("span",{className:"font-semibold",children:a("selectTenant.subtitle","Organization.")})]})}),e.jsx("p",{className:"mb-12 max-w-sm text-lg font-light leading-relaxed text-muted-foreground",children:s?"Choose a workspace to access document templates and assembly tools.":a("selectTenant.description","Choose a tenant environment to access your document templates and assembly tools.")})]}),e.jsxs("button",{onClick:ee,className:"group inline-flex items-center gap-2 font-mono text-sm text-muted-foreground transition-colors hover:text-foreground",children:[e.jsx(me,{size:16,className:"transition-transform group-hover:-translate-x-1"}),e.jsx("span",{children:s?"Back to organizations":a("selectTenant.back","Back to login")})]})]}),e.jsxs("div",{className:"flex flex-col justify-center lg:col-span-8",children:[e.jsxs("div",{className:"group relative mb-8 w-full",children:[e.jsx(xe,{className:"pointer-events-none absolute left-0 top-1/2 -translate-y-1/2 text-muted-foreground/50 transition-colors group-focus-within:text-foreground",size:20}),e.jsx("input",{type:"text",placeholder:s?"Filter by workspace...":a("selectTenant.filter","Filter by organization..."),value:r,onChange:t=>m(t.target.value),className:"w-full rounded-none border-b border-border bg-transparent py-3 pl-10 pr-4 font-display text-xl text-foreground outline-none transition-colors placeholder:text-muted-foreground/30 focus-visible:border-foreground focus-visible:ring-0"}),Y&&e.jsx("span",{className:"absolute -bottom-6 left-0 text-xs text-muted-foreground/70",children:a("selectTenant.minChars","Type at least 3 characters to search")})]}),e.jsx("div",{className:"flex w-full flex-col justify-start",style:{height:`${ge}px`},children:e.jsx(M,{mode:"wait",children:s?X?e.jsx(n.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0,transition:{duration:.4,delay:.2}},exit:{opacity:0,transition:{duration:.3}},className:"flex h-full items-start justify-center py-8 text-muted-foreground",children:e.jsxs("span",{children:["Loading workspaces",e.jsx(H,{})]})},"loading-workspaces"):I.length===0?e.jsx(n.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0,transition:{duration:.4,delay:.2}},exit:{opacity:0,transition:{duration:.3}},className:"flex h-full items-start justify-center py-8 text-muted-foreground",children:e.jsx("span",{children:a("common.noResults","No results found")})},"empty-workspaces"):e.jsx(n.div,{variants:B,initial:"hidden",animate:"visible",exit:"exit",className:"flex h-full w-full flex-col justify-start",children:I.map(t=>e.jsxs(n.button,{variants:O,onClick:j=>D(t,j),disabled:!!y,className:$("group relative -mb-px flex w-full items-center justify-between rounded-sm border border-transparent border-b-border px-4 py-6 outline-none transition-all duration-200 hover:z-10 hover:border-foreground hover:bg-accent",y&&"pointer-events-none"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-left font-display text-xl font-medium tracking-tight text-foreground md:text-2xl",children:t.name}),t.type==="SYSTEM"&&e.jsx("span",{className:"rounded-sm bg-muted px-1.5 py-0.5 font-mono text-[9px] font-bold uppercase tracking-widest text-muted-foreground",children:"System"})]}),e.jsxs("div",{className:"flex items-center gap-6 md:gap-8",children:[e.jsxs("span",{className:"whitespace-nowrap font-mono text-[10px] text-muted-foreground transition-colors group-hover:text-foreground md:text-xs",children:["Last accessed: ",Q(t.lastAccessedAt)]}),e.jsx(R,{className:"text-muted-foreground transition-all duration-300 group-hover:translate-x-1 group-hover:text-foreground",size:24})]})]},t.id))},`workspaces-page-${h}-${r.length>=3?"search":"list"}`):U?e.jsx(n.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,transition:{duration:.3}},className:"flex h-full items-start justify-center py-8 text-muted-foreground",children:e.jsxs("span",{children:["Loading organizations",e.jsx(H,{})]})},"loading-tenants"):E.length===0?e.jsx(n.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0,transition:{duration:.4,delay:.2}},exit:{opacity:0,transition:{duration:.3}},className:"flex h-full items-start justify-center py-8 text-muted-foreground",children:e.jsx("span",{children:a("common.noResults","No results found")})},"empty-tenants"):e.jsx(n.div,{variants:B,initial:"hidden",animate:"visible",exit:"exit",className:"flex h-full w-full flex-col justify-start",children:E.map(t=>e.jsxs(n.button,{variants:O,onClick:()=>Z(t),className:$("group relative -mb-px flex w-full items-center justify-between rounded-sm border border-transparent border-b-border px-4 py-6 outline-none transition-all duration-200 hover:z-10 hover:border-foreground hover:bg-accent"),children:[e.jsx("h3",{className:"text-left font-display text-xl font-medium tracking-tight text-foreground transition-transform duration-300 group-hover:translate-x-2 md:text-2xl",children:t.name}),e.jsxs("div",{className:"flex items-center gap-6 md:gap-8",children:[e.jsxs("span",{className:"whitespace-nowrap font-mono text-[10px] text-muted-foreground transition-colors group-hover:text-foreground md:text-xs",children:["Last accessed: ",Q(t.lastAccessedAt)]}),e.jsx(R,{className:"text-muted-foreground transition-all duration-300 group-hover:translate-x-1 group-hover:text-foreground",size:24})]})]},t.id))},`tenants-page-${g}-${r.length>=3?"search":"list"}`)})}),!s&&e.jsx(W,{page:g,totalPages:_,onPageChange:N,className:"py-6"}),s&&e.jsx(W,{page:h,totalPages:K,onPageChange:T,className:"py-6"}),"        "]})]})]})}export{Ie as component};
